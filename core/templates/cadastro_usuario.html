{% extends "base.html" %}

{% block content %}
<section class="form-section">
  <div class="form-container">
    <h2>Cadastro de Usuário</h2>

    {% if messages %}
      <ul class="messages">
        {% for message in messages %}
          <li class="{{ message.tags }}">{{ message }}</li>
        {% endfor %}
      </ul>
    {% endif %}

    <form method="post" id="userForm">
      {% csrf_token %}
      
      <div class="form-group">
        <label for="tipo_usuario">Tipo de Usuário:</label>
        <select id="tipo_usuario" name="tipo_usuario" required>
          <option value="comum">Comum</option>
          <option value="pesquisador">Pesquisador</option>
          <option value="instituicao">Instituição</option>
        </select>
      </div>

      <div class="form-group">
        <label for="nome">Nome completo:</label>
        <input type="text" name="nome" id="nome" required>
      </div>

      <div class="form-group">
        <label for="email">E-mail:</label>
        <input type="email" name="email" id="email" required>
      </div>

      <div class="form-group">
        <label for="senha">Senha:</label>
        <input type="password" name="senha" id="senha" required>
      </div>

      <!-- Campos extras que serão exibidos dinamicamente -->
      <div id="campos-pesquisador" class="hidden">
        <div class="form-group">
          <label for="instituicao">Instituição:</label>
          <input type="text" name="instituicao" id="instituicao">
        </div>
        <div class="form-group">
          <label for="area_pesquisa">Área de Pesquisa:</label>
          <input type="text" name="area_pesquisa" id="area_pesquisa">
        </div>
        <div class="form-group">
          <label for="registro">Registro (ex: ORCID):</label>
          <input type="text" name="registro" id="registro">
        </div>
      </div>

      <div id="campos-instituicao" class="hidden">
        <div class="form-group">
          <label for="nome_instituicao">Nome da Instituição:</label>
          <input type="text" name="nome_instituicao" id="nome_instituicao">
        </div>
        <div class="form-group">
          <label for="cnpj">CNPJ:</label>
          <input type="text" name="cnpj" id="cnpj">
        </div>
        <div class="form-group">
          <label for="responsavel">Responsável:</label>
          <input type="text" name="responsavel" id="responsavel">
        </div>
        <div class="form-group">
          <label for="telefone">Telefone:</label>
          <input type="text" name="telefone" id="telefone">
        </div>
      </div>

      <button type="submit" class="btn-submit">Cadastrar</button>
    </form>

    <p class="text-center">Já tem uma conta? 
      <a href="{% url 'login' %}" class="link">Faça login</a>
    </p>
  </div>
</section>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const tipoSelect = document.getElementById("tipo_usuario");
  const camposPesquisador = document.getElementById("campos-pesquisador");
  const camposInstituicao = document.getElementById("campos-instituicao");

  function atualizarCampos() {
    camposPesquisador.classList.add("hidden");
    camposInstituicao.classList.add("hidden");

    if (tipoSelect.value === "pesquisador") {
      camposPesquisador.classList.remove("hidden");
    } else if (tipoSelect.value === "instituicao") {
      camposInstituicao.classList.remove("hidden");
    }
  }

  tipoSelect.addEventListener("change", atualizarCampos);
});
</script>

<style>
.form-section {
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 2rem;
}

.form-container {
  background: #fff;
  padding: 2rem 3rem;
  border-radius: 12px;
  box-shadow: 0 0 20px rgba(0,0,0,0.1);
  width: 100%;
  max-width: 500px;
}

.form-container h2 {
  text-align: center;
  margin-bottom: 1rem;
}

.form-group {
  margin-bottom: 1rem;
}

.form-group label {
  display: block;
  font-weight: bold;
  margin-bottom: .3rem;
}

.form-group input, .form-group select {
  width: 100%;
  padding: .6rem;
  border-radius: 8px;
  border: 1px solid #ccc;
  transition: border-color .2s;
}

.form-group input:focus, .form-group select:focus {
  border-color: #007b5f;
  outline: none;
}

.btn-submit {
  width: 100%;
  background: #007b5f;
  color: white;
  padding: .8rem;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-weight: bold;
}

.btn-submit:hover {
  background: #009d72;
}

.hidden {
  display: none;
}

.text-center {
  text-align: center;
  margin-top: 1rem;
}

.link {
  color: #007b5f;
  font-weight: bold;
  text-decoration: none;
}
.link:hover {
  text-decoration: underline;
}
</style>
{% endblock %}
