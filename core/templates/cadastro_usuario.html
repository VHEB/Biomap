{% extends "base.html" %}

{% block content %}
<section class="form-section">
    <div class="form-container">
        <h2>Cadastro de Usuário</h2>

        <form method="post" novalidate>
            {% csrf_token %}
            {{ form.non_field_errors }}

            <div class="form-group">
                <label for="{{ form.username.id_for_label }}">Usuário</label>
                {{ form.username }}
            </div>

            <div class="form-group">
                <label for="{{ form.first_name.id_for_label }}">Nome</label>
                {{ form.first_name }}
            </div>

            <div class="form-group">
                <label for="{{ form.last_name.id_for_label }}">Sobrenome</label>
                {{ form.last_name }}
            </div>

            <div class="form-group">
                <label for="{{ form.email.id_for_label }}">E-mail</label>
                {{ form.email }}
            </div>

            <div class="form-group">
                <label for="{{ form.tipo_usuario.id_for_label }}">Tipo de Usuário</label>
                {{ form.tipo_usuario }}
            </div>

            <!-- CAMPOS PESQUISADOR -->
            <div class="extra-fields pesquisador">
                <h4>Informações do Pesquisador</h4>
                <div class="form-group">
                    <label for="{{ form.data_nascimento.id_for_label }}">Data de Nascimento</label>
                    {{ form.data_nascimento }}
                </div>
                <div class="form-group">
                    <label for="{{ form.formacao.id_for_label }}">Formação</label>
                    {{ form.formacao }}
                </div>
                <div class="form-group">
                    <label for="{{ form.instituicao_atuante.id_for_label }}">Instituição Atuante</label>
                    {{ form.instituicao_atuante }}
                </div>
                <div class="form-group">
                    <label for="{{ form.lattes.id_for_label }}">Currículo Lattes</label>
                    {{ form.lattes }}
                </div>
            </div>

            <!-- CAMPOS INSTITUIÇÃO -->
            <div class="extra-fields instituicao">
                <h4>Informações da Instituição</h4>
                <div class="form-group">
                    <label for="{{ form.nome_instituicao.id_for_label }}">Nome da Instituição</label>
                    {{ form.nome_instituicao }}
                </div>
                <div class="form-group">
                    <label for="{{ form.cnpj.id_for_label }}">CNPJ</label>
                    {{ form.cnpj }}
                </div>
                <div class="form-group">
                    <label for="{{ form.endereco.id_for_label }}">Endereço</label>
                    {{ form.endereco }}
                </div>
                <div class="form-group">
                    <label for="{{ form.contato.id_for_label }}">Contato</label>
                    {{ form.contato }}
                </div>
                <div class="form-group">
                    <label for="{{ form.website.id_for_label }}">Website</label>
                    {{ form.website }}
                </div>
            </div>

            <!-- SENHA -->
            <div class="form-group">
                <label for="{{ form.password1.id_for_label }}">Senha</label>
                {{ form.password1 }}
            </div>
            <div class="form-group">
                <label for="{{ form.password2.id_for_label }}">Confirmar Senha</label>
                {{ form.password2 }}
            </div>

            <button type="submit" class="btn-primary">Cadastrar</button>
        </form>

        <p class="text-center">
            Já possui uma conta? <a href="{% url 'login' %}">Entrar</a>
        </p>
    </div>
</section>

<style>
.form-section {
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 85vh;
}

.form-container {
    background: #fff;
    padding: 35px;
    border-radius: 15px;
    box-shadow: 0 3px 15px rgba(0,0,0,0.15);
    max-width: 600px;
    width: 100%;
}

h2 {
    text-align: center;
    margin-bottom: 25px;
}

.form-group {
    margin-bottom: 15px;
}

label {
    font-weight: 600;
    display: block;
    margin-bottom: 5px;
}

input, select, textarea {
    width: 100%;
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 8px;
    font-size: 15px;
}

button.btn-primary {
    width: 100%;
    background: #007B5E;
    color: #fff;
    border: none;
    padding: 10px;
    border-radius: 8px;
    font-size: 16px;
    cursor: pointer;
    transition: 0.2s;
}

button.btn-primary:hover {
    background: #005f46;
}

.extra-fields {
    display: none;
    margin-top: 20px;
    padding: 10px;
    background: #f9f9f9;
    border-radius: 8px;
}
</style>

<script>
document.addEventListener("DOMContentLoaded", function() {
    const tipoSelect = document.getElementById("id_tipo_usuario");
    const pesquisadorFields = document.querySelector(".extra-fields.pesquisador");
    const instituicaoFields = document.querySelector(".extra-fields.instituicao");

    function toggleFields() {
        const tipo = tipoSelect.value;
        pesquisadorFields.style.display = (tipo === "pesquisador") ? "block" : "none";
        instituicaoFields.style.display = (tipo === "instituicao") ? "block" : "none";
    }

    tipoSelect.addEventListener("change", toggleFields);
    toggleFields(); // inicializa ao carregar
});
</script>
{% endblock %}
